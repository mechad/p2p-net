UDP内网穿透实验--P2P通信测试
　　通过UDP打洞实现NAT穿越是一种在处于使用了NAT的私有网络中的Internet主机之间建立双向UDP连接的方法。由于NAT的行为是非标准化的，因此它并不能应用于所有类型的NAT。 
　　其基本思想是这样的：让位于NAT后的两台主机都与处于公共地址空间的服务器相连，然后，一旦NAT设备建立好UDP状态信息就转为直接通信，这项技术需要一个圆锥型NAT设备才能够正常工作。对称型NAT不能使用这项技术。

UDP打洞的过程大体上如下： 
主机A和主机B都是通过NAT设备访问互联网，主机S位于互联网上。 
1. A和B都与S之间通过UDP进行心跳连接 
2. A通知S，要与B通信 
3. S把B的公网IP、port告诉A，同时把A的公网IP、port告诉B 
4. A向B的公网IP、port发送数据（这个数据包应该会被丢弃，但是打开了B回来的窗户） 
5. B向A的公网IP、port发送数据（这个数据包就会被A接受，之后A和B就建立起了连接）

程序中我调用了readline库函数，所以，编译前请保证系统中已经安装了readline库。 
ubuntu安装readline库：

sudo apt-get install libreadline5-dev

实验截图如下（代码有改动，这个是实验中截图）： 
这里写图片描述

程序工作流程说明： 
1、在一个开放IP/PORT的主机上运行server程序，并设定监听端口。 
2、两个客户端程序分别运行在两个网络环境中，并且使用login 命令登录服务器，登录时需要指定服务器ip信息以及自己的登录名。登录成功服务器会自动推送用户列表到客户端。 
3、任何一方都可发起通信，通信时直接输入sendto 对方用户名 数据。 
4、链接会在第一次通信时建立，链接建立成功后服务器遍失去作用，此时关闭服务器后两个客户端依然能够正常通信。
